<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Jyotis Joy" />
    
    <link rel="shortcut icon" type="image/x-icon" href="../../img/favicon.ico">
    <title>Project 1 (F)</title>
    <meta name="generator" content="Hugo 0.83.1" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="../../css/main.css" />
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,200bold,400old" />
    
    <!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
			<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->

    
  </head>

  <body>
    <div id="wrap">
      
      <nav class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <a class="navbar-brand" href="../../"><i class="fa fa-home"></i></a>
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div class="navbar-collapse collapse" id="navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
        <li><a href="../../post/">BLOG</a></li>
        
        <li><a href="../../projects/">PROJECTS</a></li>
        
        <li><a href="../../resume/">RESUME</a></li>
        
      
      </ul>
    </div>
  </div>
</nav>

      <div class="container">
        <div class="blog-post">
          <h3>
            <strong><a href="../../project/project1/">Project 1 (F)</a></strong>
          </h3>
        </div>
 
<div class="blog-title">
          <h4>
         January 1, 0001 
            &nbsp;&nbsp;
            
          </h4>
        </div>

        <div class="panel panel-default">
          <div class="panel-body">
            <div class="blogpost">
              
<script src="../../rmarkdown-libs/kePrint/kePrint.js"></script>
<link href="../../rmarkdown-libs/lightable/lightable.css" rel="stylesheet" />


<pre class="r"><code>getwd()</code></pre>
<pre><code>## [1] &quot;/stor/home/jj37257/website/content/project&quot;</code></pre>
<pre class="r"><code>work_dir &lt;- &quot;/stor/home/jj37257/website/content/project&quot;
Marriage &lt;- read.csv(&quot;Marriage.csv&quot;)
weather &lt;- read.csv(&quot;2530921.csv&quot;)

library(dplyr)
library(ggridges)
library(tidyr)
library(ggplot2)
library(kableExtra)
library(tibble)
library(cluster)</code></pre>
<pre class="r"><code>## The data sets that I have chosen for this project were
## marriage and weather data from Mobile County, Alabama. I
## thought that these two data could go together when you
## think about how many people decide to have their ceremony
## based on the weather. People want to have a beautiful
## wedding on the perfect day, so I was wondering if there was
## a correlation between the weather and marriage ceremonies.
## Additionally, I was also curious if there was a correlation
## betweeen age, race, and delay of ceremony. The delay of
## ceremony was calculated by the number of days between the
## ceremony and the marriage application process. I was
## predicting that younger poeple would be more likely to rush
## into things and have the marriage ceremony soon after the
## application process than those who were older. As for race,
## I did not really have a prediction for it, but I was
## curious to see if there was any correlation between race
## and delay which could possibly be explained by
## socioeconomic factors.

## The variables in the marriage dataset had the application
## date, the ceremony date, the delay between the two, various
## demographic factors of the person who applied for it as
## well as who officiated their marriage. I acquired this data
## through the fivethirtyeight package. On the other hand, I
## acquired the weather dataset through the NOAA site which
## had an abundant archive for various places in the US. The
## variables in this set included the average, max, and min
## temperature for a specific day. It also included the
## precipitation levels for that day, which in Mobile County
## was not a huge variable.


joined_data &lt;- Marriage %&gt;% left_join(weather, by = c(appdate = &quot;DATE&quot;))


## To merge and tidy up the two datasets, I decided to do a
## left join since I matched both data by the dates. First, I
## looked at the marriage application dates and then proceeded
## to find the weather reports corresponding to those dates.
## The left join was the most reasonable choice to do because
## I wanted all the data from the left table, which was the
## marriage table, since that dataset had more variables I was
## going to look into. Furthermore, I needed to narrow down
## the weather dates by matching it with the marriage
## application dates.</code></pre>
<pre class="r"><code>joined_data %&gt;% na.omit() %&gt;% filter(!is.na(TAVG)) %&gt;% filter(between(delay, 
    0, 27)) %&gt;% arrange(desc(appdate), desc(TAVG)) %&gt;% select(-bookpageID, 
    -person, -dob, -prevconc, -prevcount, -STATION, -officialTitle, 
    -dayOfBirth, -hs, -college) %&gt;% select(appdate, ceremonydate, 
    delay, TAVG, TMAX, TMIN, PRCP, everything()) %&gt;% mutate(delay_cat = case_when(delay &gt; 
    15 ~ &quot;high&quot;, delay &lt;= 15 &amp; 5 &lt;= delay ~ &quot;med&quot;, delay &lt; 5 ~ 
    &quot;low&quot;))</code></pre>
<pre><code>##      appdate ceremonydate delay TAVG TMAX TMIN PRCP  X      age  race
## 1 1999-02-05   1999-02-06     1   58   71   44 0.00 49 39.15890 White
## 2 1999-02-05   1999-02-06     1   55   67   43 0.00 49 39.15890 White
## 3 1999-01-22   1999-01-31     9   70   73   66 0.68 48 67.58356 White
## 4 1999-01-22   1999-01-31     9   70   73   66 0.68 97 70.73151 White
## 5 1999-01-22   1999-01-31     9   69   73   65 0.45 48 67.58356 White
## 6 1999-01-22   1999-01-31     9   69   73   65 0.45 97 70.73151 White
## 7 1998-12-23   1998-12-23     0   45   49   40 0.01 96 22.93699 White
## 8 1998-12-23   1998-12-23     0   42   45   38 0.03 96 22.93699 White
##          sign delay_cat
## 1 Saggitarius       low
## 2 Saggitarius       low
## 3      Cancer       med
## 4      Gemini       med
## 5      Cancer       med
## 6      Gemini       med
## 7    Aquarius       low
## 8    Aquarius       low
##  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 26 rows ]</code></pre>
<pre class="r"><code>## The only case that was dropped were some of the values in
## the average temperature because the data that I acquired
## did not have all of the daily average temperatures.
## Therefore, I had to drop those after joining the two, which
## helped me narrow down my data. There were no potential
## problems with this because the marriage dataset had 98
## observations and since we only neeeded atleast 50, dropping
## a few of the data did not present a problem with the amount
## of data that was required for this project. However,
## average temperature is a crucial element of trying to
## determine if there is a correlation between weather and
## wedding delays. This aspect did present a problem in that
## it messed the the mean and other summary statistics of this
## variable.

## After joining the datasets, I was required to use the 6
## main dplyr functions. I decided to first filter the delay
## column of the data so that there were no huge outliers in
## the data. Then I proceeded to arrange the data by
## descending order of application date first which was then
## proceeded by descending order of average temperature for
## that day because some of the application dates for various
## people were similar and some of the average temperature
## datas were not recorded daily. Next, I used the select
## function to drop the unnecessary variables in the data such
## as date of birth, highschool/college level,station of the
## weather report, etc. I used the mutate function to create a
## new categorica variable where the delays were classified
## into levels of high, medium, or low.</code></pre>
<pre class="r"><code>joined_data %&gt;% summarize(mean_delay = mean(delay, na.rm = T), 
    sd_delay = sd(delay, na.rm = T), var_delay = var(delay, na.rm = T), 
    max_delay = max(delay, na.rm = T), min_delay = min(delay, 
        na.rm = T), IQR_delay = IQR(delay, na.rm = T), mean_TAVG = mean(TAVG, 
        na.rm = T), sd_TAVG = sd(TAVG, na.rm = T), var_TAVG = var(TAVG, 
        na.rm = T), max_TAVG = max(TAVG, na.rm = T), min_TAVG = min(TAVG, 
        na.rm = T), IQR_TAVG = IQR(TAVG, na.rm = T), mean_TMAX = mean(TMAX, 
        na.rm = T), sd_TMAX = sd(TMAX, na.rm = T), var_TMAX = var(TMAX, 
        na.rm = T), max_TMAX = max(TMAX, na.rm = T), min_TMAX = min(TMAX, 
        na.rm = T), IQR_TMAX = IQR(TMAX, na.rm = T), mean_TMIN = mean(TMIN, 
        na.rm = T), sd_TMIN = sd(TMIN, na.rm = T), var_TMIN = var(TMIN, 
        na.rm = T), max_TMIN = max(TMIN, na.rm = T), min_TMIN = min(TMIN, 
        na.rm = T), IQR_TMIN = IQR(TMIN, na.rm = T), mean_PRCP = mean(PRCP, 
        na.rm = T), sd_PRCP = sd(PRCP, na.rm = T), var_PRCP = var(PRCP, 
        na.rm = T), max_PRCP = max(PRCP, na.rm = T), min_PRCP = min(PRCP, 
        na.rm = T), IQR_PRCP = IQR(PRCP, na.rm = T), mean_age = mean(age, 
        na.rm = T), sd_age = sd(age, na.rm = T), var_age = var(age, 
        na.rm = T), max_age = max(age, na.rm = T), min_age = min(age, 
        na.rm = T), IQR_age = IQR(age, na.rm = T), n_rows = n()) %&gt;% 
    pivot_longer(contains(&quot;_&quot;)) %&gt;% separate(name, into = c(&quot;type&quot;, 
    &quot;numeric variable&quot;)) %&gt;% kbl() %&gt;% kable_styling()</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
type
</th>
<th style="text-align:left;">
numeric variable
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
mean
</td>
<td style="text-align:left;">
delay
</td>
<td style="text-align:right;">
5.6197917
</td>
</tr>
<tr>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
delay
</td>
<td style="text-align:right;">
7.0999006
</td>
</tr>
<tr>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
delay
</td>
<td style="text-align:right;">
50.4085890
</td>
</tr>
<tr>
<td style="text-align:left;">
max
</td>
<td style="text-align:left;">
delay
</td>
<td style="text-align:right;">
28.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
min
</td>
<td style="text-align:left;">
delay
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
IQR
</td>
<td style="text-align:left;">
delay
</td>
<td style="text-align:right;">
9.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
mean
</td>
<td style="text-align:left;">
TAVG
</td>
<td style="text-align:right;">
70.5000000
</td>
</tr>
<tr>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
TAVG
</td>
<td style="text-align:right;">
12.2635381
</td>
</tr>
<tr>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
TAVG
</td>
<td style="text-align:right;">
150.3943662
</td>
</tr>
<tr>
<td style="text-align:left;">
max
</td>
<td style="text-align:left;">
TAVG
</td>
<td style="text-align:right;">
87.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
min
</td>
<td style="text-align:left;">
TAVG
</td>
<td style="text-align:right;">
42.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
IQR
</td>
<td style="text-align:left;">
TAVG
</td>
<td style="text-align:right;">
21.5000000
</td>
</tr>
<tr>
<td style="text-align:left;">
mean
</td>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
74.9157895
</td>
</tr>
<tr>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
12.4100250
</td>
</tr>
<tr>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
154.0087210
</td>
</tr>
<tr>
<td style="text-align:left;">
max
</td>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
96.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
min
</td>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
45.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
IQR
</td>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
20.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
mean
</td>
<td style="text-align:left;">
TMIN
</td>
<td style="text-align:right;">
57.2578947
</td>
</tr>
<tr>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
TMIN
</td>
<td style="text-align:right;">
14.2574080
</td>
</tr>
<tr>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
TMIN
</td>
<td style="text-align:right;">
203.2736842
</td>
</tr>
<tr>
<td style="text-align:left;">
max
</td>
<td style="text-align:left;">
TMIN
</td>
<td style="text-align:right;">
82.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
min
</td>
<td style="text-align:left;">
TMIN
</td>
<td style="text-align:right;">
29.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
IQR
</td>
<td style="text-align:left;">
TMIN
</td>
<td style="text-align:right;">
26.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
mean
</td>
<td style="text-align:left;">
PRCP
</td>
<td style="text-align:right;">
0.0672840
</td>
</tr>
<tr>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
PRCP
</td>
<td style="text-align:right;">
0.2129958
</td>
</tr>
<tr>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
PRCP
</td>
<td style="text-align:right;">
0.0453672
</td>
</tr>
<tr>
<td style="text-align:left;">
max
</td>
<td style="text-align:left;">
PRCP
</td>
<td style="text-align:right;">
1.7100000
</td>
</tr>
<tr>
<td style="text-align:left;">
min
</td>
<td style="text-align:left;">
PRCP
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
IQR
</td>
<td style="text-align:left;">
PRCP
</td>
<td style="text-align:right;">
0.0100000
</td>
</tr>
<tr>
<td style="text-align:left;">
mean
</td>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
34.6517765
</td>
</tr>
<tr>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
14.4451688
</td>
</tr>
<tr>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
208.6629008
</td>
</tr>
<tr>
<td style="text-align:left;">
max
</td>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
74.2465753
</td>
</tr>
<tr>
<td style="text-align:left;">
min
</td>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
16.2712329
</td>
</tr>
<tr>
<td style="text-align:left;">
IQR
</td>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
21.5917808
</td>
</tr>
<tr>
<td style="text-align:left;">
n
</td>
<td style="text-align:left;">
rows
</td>
<td style="text-align:right;">
384.0000000
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>## My dataset was already tidy after joining it, so I waited
## till after summarize() to tidy the data since it made my
## tables look a little messy. When using just the general
## summarize function by itself, I just had to tidy the data
## from wide to long since there were not that many variables.
## I used the pivot longer function to seperate my numeric
## variables, such as max and min temperature, delay, and
## percipitation, into the type of summary that was generated
## such as mean, sd, and var. In order to do that, I first had
## to seperate the name by the &#39;_&#39; because when summarizing I
## had created a new variable with that notation in it. After
## seoerating the name, I renamed the variables accordingly.
## On the other hand, when using the group by function, I had
## to use both pivot wider and longer because there were
## multiple rows and columns of each variable. It had made the
## dataset very long, so the most reasonable method was to
## combine the two pivot functions and group the variables
## accordingly as was done when just the summarize function
## was used.</code></pre>
<pre class="r"><code>joined_data %&gt;% group_by(appdate, delay, PRCP, race, sign) %&gt;% 
    summarize(mean_TAVG = mean(TAVG, na.rm = T), sd_TAVG = sd(TAVG, 
        na.rm = T), var_TAVG = var(TAVG, na.rm = T), max_TAVG = max(TAVG, 
        na.rm = T), min_TAVG = min(TAVG, na.rm = T), IQR_TAVG = IQR(TAVG, 
        na.rm = T), mean_TMAX = mean(TMAX, na.rm = T), sd_TMAX = sd(TMAX, 
        na.rm = T), var_TMAX = var(TMAX, na.rm = T), max_TMAX = max(TMAX, 
        na.rm = T), min_TMAX = min(TMAX, na.rm = T), IQR_TMAX = IQR(TMAX, 
        na.rm = T), mean_TMIN = mean(TMIN, na.rm = T), sd_TMIN = sd(TMIN, 
        na.rm = T), var_TMIN = var(TMIN, na.rm = T), max_TMIN = max(TMIN, 
        na.rm = T), min_TMIN = min(TMIN, na.rm = T), IQR_TMIN = IQR(TMIN, 
        na.rm = T)) %&gt;% distinct(appdate, .keep_all = TRUE) %&gt;% 
    na.omit() %&gt;% pivot_longer(contains(&quot;_&quot;)) %&gt;% separate(name, 
    into = c(&quot;type&quot;, &quot;numeric variables&quot;)) %&gt;% pivot_wider(names_from = &quot;type&quot;, 
    values_from = &quot;value&quot;) %&gt;% kbl() %&gt;% kable_styling()</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
appdate
</th>
<th style="text-align:right;">
delay
</th>
<th style="text-align:right;">
PRCP
</th>
<th style="text-align:left;">
race
</th>
<th style="text-align:left;">
sign
</th>
<th style="text-align:left;">
numeric variables
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
var
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
IQR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1998-04-23
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Aries
</td>
<td style="text-align:left;">
TAVG
</td>
<td style="text-align:right;">
59.00000
</td>
<td style="text-align:right;">
1.4142136
</td>
<td style="text-align:right;">
2.0000000
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-04-23
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Aries
</td>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
70.66667
</td>
<td style="text-align:right;">
0.5773503
</td>
<td style="text-align:right;">
0.3333333
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
0.50
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-04-23
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Aries
</td>
<td style="text-align:left;">
TMIN
</td>
<td style="text-align:right;">
45.66667
</td>
<td style="text-align:right;">
2.0816660
</td>
<td style="text-align:right;">
4.3333333
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
2.00
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-05-26
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Cancer
</td>
<td style="text-align:left;">
TAVG
</td>
<td style="text-align:right;">
78.00000
</td>
<td style="text-align:right;">
1.4142136
</td>
<td style="text-align:right;">
2.0000000
</td>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
77
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-05-26
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Cancer
</td>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
87.50000
</td>
<td style="text-align:right;">
2.0816660
</td>
<td style="text-align:right;">
4.3333333
</td>
<td style="text-align:right;">
90
</td>
<td style="text-align:right;">
85
</td>
<td style="text-align:right;">
2.00
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-05-26
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Cancer
</td>
<td style="text-align:left;">
TMIN
</td>
<td style="text-align:right;">
70.75000
</td>
<td style="text-align:right;">
4.5000000
</td>
<td style="text-align:right;">
20.2500000
</td>
<td style="text-align:right;">
77
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
4.75
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-06-09
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Aquarius
</td>
<td style="text-align:left;">
TAVG
</td>
<td style="text-align:right;">
82.50000
</td>
<td style="text-align:right;">
0.7071068
</td>
<td style="text-align:right;">
0.5000000
</td>
<td style="text-align:right;">
83
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
0.50
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-06-09
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Aquarius
</td>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
86.25000
</td>
<td style="text-align:right;">
2.8722813
</td>
<td style="text-align:right;">
8.2500000
</td>
<td style="text-align:right;">
90
</td>
<td style="text-align:right;">
84
</td>
<td style="text-align:right;">
3.75
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-06-09
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Aquarius
</td>
<td style="text-align:left;">
TMIN
</td>
<td style="text-align:right;">
71.75000
</td>
<td style="text-align:right;">
7.2743843
</td>
<td style="text-align:right;">
52.9166667
</td>
<td style="text-align:right;">
77
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
4.75
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-06-18
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Black
</td>
<td style="text-align:left;">
Leo
</td>
<td style="text-align:left;">
TAVG
</td>
<td style="text-align:right;">
86.50000
</td>
<td style="text-align:right;">
0.7071068
</td>
<td style="text-align:right;">
0.5000000
</td>
<td style="text-align:right;">
87
</td>
<td style="text-align:right;">
86
</td>
<td style="text-align:right;">
0.50
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-06-18
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Black
</td>
<td style="text-align:left;">
Leo
</td>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
92.50000
</td>
<td style="text-align:right;">
2.6457513
</td>
<td style="text-align:right;">
7.0000000
</td>
<td style="text-align:right;">
96
</td>
<td style="text-align:right;">
90
</td>
<td style="text-align:right;">
3.00
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-06-18
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Black
</td>
<td style="text-align:left;">
Leo
</td>
<td style="text-align:left;">
TMIN
</td>
<td style="text-align:right;">
78.75000
</td>
<td style="text-align:right;">
2.2173558
</td>
<td style="text-align:right;">
4.9166667
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
77
</td>
<td style="text-align:right;">
1.25
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-07-31
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Pisces
</td>
<td style="text-align:left;">
TAVG
</td>
<td style="text-align:right;">
87.00000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
87
</td>
<td style="text-align:right;">
87
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-07-31
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Pisces
</td>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
92.75000
</td>
<td style="text-align:right;">
1.7078251
</td>
<td style="text-align:right;">
2.9166667
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
1.75
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-07-31
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Pisces
</td>
<td style="text-align:left;">
TMIN
</td>
<td style="text-align:right;">
79.25000
</td>
<td style="text-align:right;">
0.9574271
</td>
<td style="text-align:right;">
0.9166667
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
1.25
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-10-14
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Cancer
</td>
<td style="text-align:left;">
TAVG
</td>
<td style="text-align:right;">
71.00000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-10-14
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Cancer
</td>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
81.50000
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
0.50
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-10-14
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Cancer
</td>
<td style="text-align:left;">
TMIN
</td>
<td style="text-align:right;">
61.75000
</td>
<td style="text-align:right;">
6.1846584
</td>
<td style="text-align:right;">
38.2500000
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
3.25
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-11-09
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Black
</td>
<td style="text-align:left;">
Gemini
</td>
<td style="text-align:left;">
TAVG
</td>
<td style="text-align:right;">
68.50000
</td>
<td style="text-align:right;">
2.1213203
</td>
<td style="text-align:right;">
4.5000000
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
1.50
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-11-09
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Black
</td>
<td style="text-align:left;">
Gemini
</td>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
77.50000
</td>
<td style="text-align:right;">
1.7320508
</td>
<td style="text-align:right;">
3.0000000
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
76
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-11-09
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Black
</td>
<td style="text-align:left;">
Gemini
</td>
<td style="text-align:left;">
TMIN
</td>
<td style="text-align:right;">
56.50000
</td>
<td style="text-align:right;">
5.2599113
</td>
<td style="text-align:right;">
27.6666667
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
4.50
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-11-12
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Virgo
</td>
<td style="text-align:left;">
TAVG
</td>
<td style="text-align:right;">
59.00000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-11-12
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Virgo
</td>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
68.75000
</td>
<td style="text-align:right;">
2.4348658
</td>
<td style="text-align:right;">
5.9285714
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
4.25
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-11-12
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Virgo
</td>
<td style="text-align:left;">
TMIN
</td>
<td style="text-align:right;">
49.50000
</td>
<td style="text-align:right;">
5.2644359
</td>
<td style="text-align:right;">
27.7142857
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
3.00
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-12-14
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Cancer
</td>
<td style="text-align:left;">
TAVG
</td>
<td style="text-align:right;">
54.00000
</td>
<td style="text-align:right;">
1.4142136
</td>
<td style="text-align:right;">
2.0000000
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-12-14
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Cancer
</td>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
59.25000
</td>
<td style="text-align:right;">
4.5000000
</td>
<td style="text-align:right;">
20.2500000
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
4.75
</td>
</tr>
<tr>
<td style="text-align:left;">
1998-12-14
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Cancer
</td>
<td style="text-align:left;">
TMIN
</td>
<td style="text-align:right;">
46.75000
</td>
<td style="text-align:right;">
2.0615528
</td>
<td style="text-align:right;">
4.2500000
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
1.25
</td>
</tr>
<tr>
<td style="text-align:left;">
1999-02-05
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Saggitarius
</td>
<td style="text-align:left;">
TAVG
</td>
<td style="text-align:right;">
56.50000
</td>
<td style="text-align:right;">
2.1213203
</td>
<td style="text-align:right;">
4.5000000
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
1.50
</td>
</tr>
<tr>
<td style="text-align:left;">
1999-02-05
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Saggitarius
</td>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
69.75000
</td>
<td style="text-align:right;">
4.1129876
</td>
<td style="text-align:right;">
16.9166667
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
5.25
</td>
</tr>
<tr>
<td style="text-align:left;">
1999-02-05
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
Saggitarius
</td>
<td style="text-align:left;">
TMIN
</td>
<td style="text-align:right;">
47.00000
</td>
<td style="text-align:right;">
6.6833126
</td>
<td style="text-align:right;">
44.6666667
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
3.50
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>## Summarize the procedure and discuss all (or the most
## interesting) results in no more than two paragraphs The
## summarize function had to be the most tedious of the ones
## we had to use. There were a lot of summary statistics that
## I wanted to generate for each of my numerical data. For
## this one, I also had to make sure that duplicated rows were
## not being repeated, so I added a distinct function in the
## code to remove any duplicated rows. This was the most
## interesting to me because the data looked clean and I was
## able to see all the variables that I was interested in and
## the major summary statistics at one place.</code></pre>
<pre class="r"><code>joined_data %&gt;% na.omit() %&gt;% filter(!is.na(TAVG)) %&gt;% select_if(is.numeric) %&gt;% 
    cor(use = &quot;pair&quot;) %&gt;% as.data.frame %&gt;% rownames_to_column(&quot;var1&quot;) %&gt;% 
    pivot_longer(-1, names_to = &quot;var2&quot;, values_to = &quot;correlation&quot;) %&gt;% 
    ggplot(aes(var1, var2, fill = correlation)) + geom_tile() + 
    scale_fill_gradient2(low = &quot;red&quot;, mid = &quot;white&quot;, high = &quot;blue&quot;) + 
    geom_text(aes(label = round(correlation, 2)), color = &quot;black&quot;, 
        size = 4) + theme(axis.text.x = element_text(angle = 90, 
    hjust = 1)) + xlab(&quot;&quot;) + ylab(&quot;&quot;) + coord_fixed()</code></pre>
<p><img src="../../project/project1_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>## This plot is the correlation plot and it showed the
## strength of association of the variables with each other.
## This plot is important because a value close to 1 indicates
## a strong correlation whereas a value close to 0 indicates
## poor correlation. As with the numbers, it is also important
## to make note of the signs of the values as that indicates
## the direction of correlation. A positive value indicates a
## upward correlation where as one variable increases so does
## the other. A negative value indicates that as one variable
## decreases, the other increases. The noteworthy trends that
## were apparent in this plot was that there was a strong
## correlation between mininum temperature and age as well as
## delay and age. This led me to infer that young people were
## more likely to have their ceremony sooner than those who
## were older. Furthermore, younger people were more likely to
## go get married when the temperature was warmer.</code></pre>
<pre class="r"><code>plot1 &lt;- ggplot(data = joined_data, aes(x = delay, y = PRCP)) + 
    geom_line(aes(color = age)) + geom_point(size = 2, color = &quot;gray&quot;) + 
    theme(legend.position = &quot;top&quot;)
plot1 + ggtitle(&quot;Influence of weather and age on delays in Marriage&quot;) + 
    ylab(&quot;Rainfall (in)&quot;) + xlab(&quot;Delay (days)&quot;)</code></pre>
<p><img src="../../project/project1_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot1 + facet_wrap(~race)</code></pre>
<p><img src="../../project/project1_files/figure-html/unnamed-chunk-7-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>## The second plot that I decided to do was a linear plot that
## the specifically tested the relationship of weather and age
## on delays in marriage ceremonies. As can be seen in the
## first plot, younger people were more likely to delay their
## ceremony if it was raining a certain day. Older people were
## more likely than younger people to delay the ceremony
## regardless of rainfall. This plot does not show the most
## substanttial data because I think more points were needed.
## A strong correlation between the variables could not be
## determined by this plot. Additionally, I decided to facet
## the data and look at specific race. In the second plot, it
## can be assumed that African Americans would have their
## ceremonies sooner than the other races regardless of
## percipitation and white people were the second race to not
## delay the wedding. However, an important fact to note here
## is that this data may not have been very proportionate when
## it comes to accounting for races. There were far less
## American Indian and Hispanic people in this data,
## therefore, a strong assumption cannot be made.</code></pre>
<pre class="r"><code>plot2 &lt;- ggplot(joined_data) + aes(x = sign, y = delay, color = age) + 
    geom_errorbar(stat = &quot;summary&quot;, width = 0.2) + scale_fill_hue(c = 70) + 
    geom_bar(size = 2, color = &quot;blue&quot;, stat = &quot;summary&quot;, fun = mean)
plot2 + ggtitle(&quot;Influence of birth sign and age on marriage delays&quot;) + 
    ylab(&quot;Delays (days)&quot;) + xlab(&quot;Sign&quot;)</code></pre>
<p><img src="../../project/project1_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>## The last plot that I decided to do to visualize my data was
## a histogram with standard errors. I decided to look at the
## influence of the variables birth sign and age on marriage
## delays. I was expecting to see a slight trend with this one
## because I was thinking that there are some people who are
## really into horoscopes and would be influenced by their
## star signs on an important day. As can be seen in the plot,
## there is not a normal distribution, it seems to be bimodial
## with more Aries and Sagitarius delaying their marriage.
## Capricorns were the least to delay their ceremony. The
## standard error bars seem to be equaly proportionate
## throughtout the plot.</code></pre>
<pre class="r"><code>dat2 &lt;- joined_data %&gt;% select(-bookpageID, -person, -dob, -prevconc, 
    -prevcount, -STATION, -officialTitle, -dayOfBirth, -hs, -college) %&gt;% 
    select(appdate, ceremonydate, delay, TAVG, TMAX, TMIN, PRCP, 
        everything()) %&gt;% mutate_if(is.character, as.factor)

gower1 &lt;- daisy(dat2, metric = &quot;gower&quot;)
pam3 &lt;- pam(gower1, k = 3, diss = T)

sil_width &lt;- vector()
for (i in 2:10) {
    pam_fit &lt;- pam(gower1, diss = TRUE, k = i)
    sil_width[i] &lt;- pam_fit$silinfo$avg.width
}
ggplot() + geom_line(aes(x = 1:10, y = sil_width)) + scale_x_continuous(name = &quot;k&quot;, 
    breaks = 1:10)</code></pre>
<p><img src="../../project/project1_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>pam3 &lt;- pam(gower1, k = 2, diss = T)
pam3</code></pre>
<pre><code>## Medoids:
##       ID    
## [1,] 175 175
## [2,] 167 167
## Clustering vector:
##   [1] 1 1 1 1 1 1 1 1 1 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 1 1 1 1
##  [38] 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 1 1 1 1 1 1
##  [75] 1 1 1 1 1 1 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1
##  [ reached getOption(&quot;max.print&quot;) -- omitted 284 entries ]
## Objective function:
##     build      swap 
## 0.3959398 0.3959398 
## 
## Available components:
## [1] &quot;medoids&quot;    &quot;id.med&quot;     &quot;clustering&quot; &quot;objective&quot;  &quot;isolation&quot; 
## [6] &quot;clusinfo&quot;   &quot;silinfo&quot;    &quot;diss&quot;       &quot;call&quot;</code></pre>
<pre class="r"><code>gower1 %&gt;% as.matrix %&gt;% as.data.frame %&gt;% rownames_to_column %&gt;% 
    pivot_longer(-1, values_to = &quot;distance&quot;) %&gt;% filter(rowname != 
    name) %&gt;% distinct(distance, .keep_all = T) %&gt;% filter(distance %in% 
    c(min(distance), max(distance)))</code></pre>
<pre><code>## # A tibble: 2 x 3
##   rowname name  distance
##   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;
## 1 4       5        0    
## 2 32      340      0.842</code></pre>
<pre class="r"><code>joined_data %&gt;% slice(32, 340)</code></pre>
<pre><code>##    X bookpageID    appdate ceremonydate delay     officialTitle person
## 1  9  B230p1948 1997-03-03   1997-03-31    28 MARRIAGE OFFICIAL  Groom
## 2 87   B234p687 1998-07-31   1998-07-31     0 MARRIAGE OFFICIAL  Bride
##          dob      age  race prevcount prevconc hs college dayOfBirth
## 1 1975-12-04 21.33699 Black         0     &lt;NA&gt; 12       0        338
## 2 2025-10-29 72.80274 White         1  Divorce 12       2        302
##          sign     STATION PRCP TAVG TMAX TMIN
## 1 Saggitarius USW00013838   NA   NA   73   54
## 2     Scorpio USW00013894    0   87   95   78</code></pre>
<pre class="r"><code>joined_data %&gt;% slice(4, 5)</code></pre>
<pre><code>##   X bookpageID    appdate ceremonydate delay     officialTitle person
## 1 2   B230p677 1996-11-12   1996-11-12     0 MARRIAGE OFFICIAL  Groom
## 2 2   B230p677 1996-11-12   1996-11-12     0 MARRIAGE OFFICIAL  Groom
##          dob      age  race prevcount prevconc hs college dayOfBirth sign
## 1 2064-08-06 32.29041 White         1  Divorce 12       0        219  Leo
## 2 2064-08-06 32.29041 White         1  Divorce 12       0        219  Leo
##       STATION PRCP TAVG TMAX TMIN
## 1 USW00013838   NA   NA   64   41
## 2 USW00013894    0   NA   64   41</code></pre>
<pre class="r"><code>dat2 %&gt;% mutate(cluster = pam3$clustering) %&gt;% group_by(cluster) %&gt;% 
    mutate(n = n()) %&gt;% summarize_at(2:8, mean, na.rm = T)</code></pre>
<pre><code>## # A tibble: 2 x 8
##   cluster ceremonydate delay  TAVG  TMAX  TMIN   PRCP     X
##     &lt;int&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1       1           NA  5.92  70.1  75.0  57.7 0.0529  51.1
## 2       2           NA  4.53  72.6  74.6  55.7 0.120   45.6</code></pre>
<pre class="r"><code>dat2 %&gt;% mutate(cluster = pam3$clustering) %&gt;% rename_all(function(x) sub(&quot;_&quot;, 
    &quot;.&quot;, x)) %&gt;% group_by(cluster) %&gt;% mutate(n = n()) %&gt;% group_by(cluster, 
    n) %&gt;% summarize_at(3:7, .funs = list(mean = mean, median = median, 
    sd = sd), na.rm = T) %&gt;% pivot_longer(contains(&quot;_&quot;)) %&gt;% 
    separate(name, sep = &quot;_&quot;, into = c(&quot;variable&quot;, &quot;stat&quot;)) %&gt;% 
    pivot_wider(names_from = &quot;variable&quot;, values_from = &quot;value&quot;) %&gt;% 
    arrange(stat)</code></pre>
<pre><code>## # A tibble: 6 x 8
## # Groups:   cluster [2]
##   cluster     n stat   delay  TAVG  TMAX  TMIN   PRCP
##     &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1       1   301 mean    5.92  70.1  75.0  57.7 0.0529
## 2       2    83 mean    4.53  72.6  74.6  55.7 0.120 
## 3       1   301 median  4     70.5  76    60   0     
## 4       2    83 median  2     76    76    54   0     
## 5       1   301 sd      6.78  11.6  12.4  14.1 0.148 
## 6       2    83 sd      8.10  15.7  12.6  14.8 0.360</code></pre>
<pre class="r"><code>plot(pam3, which = 2)</code></pre>
<p><img src="../../project/project1_files/figure-html/unnamed-chunk-9-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>pam3$silinfo$widths %&gt;% as.data.frame %&gt;% mutate(x = 384:1) %&gt;% 
    ggplot(aes(x, y = sil_width, fill = as.factor(cluster))) + 
    geom_bar(stat = &quot;identity&quot;) + xlab(&quot;sil_width&quot;) + facet_grid(cluster ~ 
    ., scales = &quot;free_y&quot;) + coord_flip() + theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="../../project/project1_files/figure-html/unnamed-chunk-9-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>## Supporting paragraph or two describing results found,
## interpreting the clusters/PCs in terms of the original
## variables and observations, discussing goodness of fit or
## variance explained, etc.

## First, I decided to cluster using categorical variables
## with Gower dissimilarities. It is important to pick the
## right number of cluster. As can be seen by the first plot,
## 2 is the best because silhouette width indexes how well
## points are assigned to their cluster. Higher silhouette
## width is better because it is more separated and smaller
## number of clusters are more parsimonious. After figuring
## out the number of clusters, I used that in accordance with
## PAM to find which variables of my data are the most similar
## and the most different. The most different was between a
## male who had a 28 day delay and a woman who had a 0 day
## delay. They were complete oposites in all aspects of the
## data. The most similar were two grooms who had the same
## application and ceremony date as well as race and age
## similarity. After, I decided to do summary statistics for
## numeric variables by cluster. Through this I found that
## cluster 1 had greater delay than cluster 2. Then I looked
## for the proportions for each statistics. I found that most
## that the most delayed group was in cluster 1 and cluster 1
## is least likely to have their ceremony on a rainy day.
## CLuster 2 is more likely to have their ceremony on a warmer
## day. It is important to not that there is an uneven
## distribution within the clusters thereby making the data
## misleading. Next, when looking at in terms of goodness of
## fitm the plot does not look too great. The average
## silhoutte width is 0.18 which means that no substantial
## structure has been found.</code></pre>

            
        <hr>         <div class="related-posts">
                <h5>Related Posts</h5>
                
              </div> 
            </div>
          </div>

   <hr>  <div class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">

    (function() {
      
      
      if (window.location.hostname == "localhost")
        return;

      var disqus_shortname = '';
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div> 
        </div>
      </div>
    </div>

    
    <footer>
  <div id="footer">
    <div class="container">
      <p class="text-muted">&copy; All rights reserved. Powered by <a href="https://gohugo.io/">Hugo</a> and
      <a href="http://www.github.com/nurlansu/hugo-sustain/">sustain</a> with â™¥</p>
    </div>
  </div>
</footer>
<div class="footer"></div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="../../js/docs.min.js"></script>
<script src="../../js/main.js"></script>

<script src="../../js/ie10-viewport-bug-workaround.js"></script>


    
  </body>
</html>
